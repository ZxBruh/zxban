import os
from telethon import events

# –ü—É—Ç—å –∫ –º–æ–¥—É–ª—è–º –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
MODULES_DIR = 'modules'

@events.register(events.NewMessage(outgoing=True, pattern=r'\!—Ö–µ–ª–ø'))
async def smart_help(event):
    # 1. –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (–∏–∑ —Ç–≤–æ–µ–≥–æ main.py)
    system_cmds = [
        "üîπ `!—Ö–µ–ª–ø` ‚Äî –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ –º–µ–Ω—é",
        "üîπ `!–∫—Ñ–≥` ‚Äî –û—Ç–∫—Ä—ã—Ç—å –∏–Ω–ª–∞–π–Ω-–º–µ–Ω—é (–∫–Ω–æ–ø–∫–∏)",
        "üîπ `!set_token` ‚Äî –ü—Ä–∏–≤—è–∑–∞—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞",
        "üîπ `!–∑–∞–≥—Ä—É–∑` ‚Äî –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥—É–ª—å (—Ä–µ–ø–ª–∞–µ–º –Ω–∞ —Ñ–∞–π–ª)"
    ]

    # 2. –°–∫–∞–Ω–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏
    if os.path.exists(MODULES_DIR):
        files = [f[:-3] for f in os.listdir(MODULES_DIR) if f.endswith('.py') and f != 'help.py']
    else:
        files = []

    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
    text = "üõ°Ô∏è **Zxban: –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥**\n"
    text += "‚Äî" * 20 + "\n\n"
    
    text += "‚öôÔ∏è **–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**\n"
    text += "\n".join(system_cmds) + "\n\n"

    text += "üß© **–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏:**\n"
    if files:
        # –í—ã–≤–æ–¥–∏–º –º–æ–¥—É–ª–∏ –∫—Ä–∞—Å–∏–≤—ã–º —Å–ø–∏—Å–∫–æ–º
        text += "\n".join([f"üîπ `{name}` ‚Äî –∞–∫—Ç–∏–≤–µ–Ω" for name in sorted(files)])
    else:
        text += "üîπ _–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π –Ω–µ—Ç_"

    text += "\n\n" + "‚Äî" * 20 + "\n"
    text += "üí° *–°–æ–≤–µ—Ç:* –∏—Å–ø–æ–ª—å–∑—É–π `!–∑–∞–≥—Ä—É–∑` –Ω–∞ —Ñ–∞–π–ª .py, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –≤ —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫."

    await event.edit(text)
